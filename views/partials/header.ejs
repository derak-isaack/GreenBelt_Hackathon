<header class="fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-md border-b border-border">
  <div class="container mx-auto px-4 py-4">
    <div class="flex items-center justify-between">
      <a href="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity">
        <img src="/assets/generated/forest-tracker-logo-transparent.dim_200x200.png" alt="Forest Tracker" class="h-10 w-10" onerror="this.style.display='none'">
        <span class="text-xl font-bold text-forest-primary">Forest Tracker</span>
      </a>

      <!-- Desktop Navigation - Right Side -->
      <nav class="hidden md:flex items-center gap-6 ml-auto">
        <a href="/" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors <%= currentPath === '/' ? 'text-forest-primary' : '' %>">Home</a>
        <a href="/dashboard" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors <%= currentPath === '/dashboard' ? 'text-forest-primary' : '' %>">Dashboard</a>
        <a href="/resources" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors <%= currentPath === '/resources' ? 'text-forest-primary' : '' %>">Resources</a>
        <a href="/report" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors <%= currentPath === '/report' ? 'text-forest-primary' : '' %>">Report</a>
        <button type="button" id="loginBtn" class="btn btn-primary">
          <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          Login
        </button>
      </nav>

      <!-- Mobile Menu Button -->
      <button id="mobileMenuBtn" class="md:hidden p-2 hover:bg-muted rounded-md">
        <svg id="menuIcon" class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <svg id="closeIcon" class="h-5 w-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <nav id="mobileMenu" class="md:hidden hidden mt-4 pb-4 flex flex-col gap-3">
      <a href="/" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors py-2 <%= currentPath === '/' ? 'text-forest-primary' : '' %>">Home</a>
      <a href="/dashboard" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors py-2 <%= currentPath === '/dashboard' ? 'text-forest-primary' : '' %>">Dashboard</a>
      <a href="/resources" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors py-2 <%= currentPath === '/resources' ? 'text-forest-primary' : '' %>">Resources</a>
      <a href="/report" class="text-sm font-medium text-foreground/80 hover:text-forest-primary transition-colors py-2 <%= currentPath === '/report' ? 'text-forest-primary' : '' %>">Report</a>
      <button type="button" id="mobileLoginBtn" class="btn btn-primary w-full mt-2">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
        </svg>
        Login
      </button>
    </nav>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuIcon = document.getElementById('menuIcon');
    const closeIcon = document.getElementById('closeIcon');
    const loginBtn = document.getElementById('loginBtn');
    const mobileLoginBtn = document.getElementById('mobileLoginBtn');
    
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        const isOpen = !mobileMenu.classList.contains('hidden');
        mobileMenu.classList.toggle('hidden');
        menuIcon.classList.toggle('hidden');
        closeIcon.classList.toggle('hidden');
      });
    }

    // Check if user is logged in first
    const authToken = localStorage.getItem('authToken');
    const username = localStorage.getItem('username');
    
    // Login button handlers - redirect to login page or logout
    const handleLogin = (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      if (authToken) {
        // User is logged in, show logout confirmation
        if (confirm('Do you want to log out?')) {
          localStorage.removeItem('authToken');
          localStorage.removeItem('username');
          localStorage.removeItem('rememberMe');
          window.location.reload();
        }
      } else {
        // User is not logged in, redirect to login page
        const currentPath = window.location.pathname;
        window.location.href = '/login?redirect=' + encodeURIComponent(currentPath);
      }
    };

    // Update button text if logged in
    if (authToken && loginBtn) {
      const icon = loginBtn.querySelector('svg') ? loginBtn.querySelector('svg').outerHTML : '';
      loginBtn.innerHTML = icon + (username || 'Account');
    }
    
    if (authToken && mobileLoginBtn) {
      const icon = mobileLoginBtn.querySelector('svg') ? mobileLoginBtn.querySelector('svg').outerHTML : '';
      mobileLoginBtn.innerHTML = icon + (username || 'Account');
    }

    // Add event listeners
    if (loginBtn) {
      loginBtn.addEventListener('click', handleLogin);
    }
    if (mobileLoginBtn) {
      mobileLoginBtn.addEventListener('click', handleLogin);
    }
  });
</script>

